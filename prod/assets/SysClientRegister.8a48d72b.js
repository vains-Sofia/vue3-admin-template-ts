import{c as N}from"./Utils.fcf89101.js";import{g as te,c as le}from"./ClientApi.c08bf63e.js";import{n as F}from"./IdWorker.6114c90c.js";import{d as ue,k as _,j as oe,r as a,o as c,c as g,w as u,m as r,b as t,e as d,f as E,g as A,h as b,F as C,i as ne,I as q,x as ae,y as se,J as ie}from"./index.f38b905c.js";import{_ as re}from"./_plugin-vue_export-helper.cdc0426e.js";import"./Request.64893a2b.js";const V=k=>(ae("data-v-8cef9315"),k=k(),se(),k),de={class:"client-info base-shadow base-not-bottom-padding basic-info-media-set"},ce=V(()=>r("div",{class:"header-text"},"\u57FA\u672C\u4FE1\u606F",-1)),pe={style:{"margin-left":"62px"},class:"app-logo"},me=V(()=>r("div",{class:"header-text"},"\u5E94\u7528Logo",-1)),fe={class:"base-shadow base-padding"},ve={class:"other-settings"},_e={class:"app-url"},ge=V(()=>r("div",{class:"header-text"},"\u8BA4\u8BC1\u76F8\u5173\u8BBE\u7F6E",-1)),ke={class:"client-settings"},he={class:"el-input"},Se=ue({__name:"SysClientRegister",setup(k){const e=_({}),U=()=>{e.value={},e.value.tokenSettings={},e.value.clientSettings={},e.value.redirectUris=[],e.value.redirectUris.push(""),e.value.clientId=String(F()),e.value.clientSecret=String(F()),e.value.scopes=[],e.value.scopes.push("read")};U();const P=oe(()=>{const n=window.localStorage.getItem("token");return n?new Headers({Authorization:n}):null}),z=()=>{e.value.clientId=String(F())},M=()=>{e.value.clientSecret=String(F())},D=_({});te().then(n=>{D.value=n});const O=(n,l)=>{n?ie.confirm(`\u786E\u5B9A\u5220\u9664\u56DE\u8C03\u5730\u5740\uFF1A${n}\u5417\uFF1F`,"Warning",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{e.value.redirectUris.splice(l,1)}):e.value.redirectUris.splice(l,1)},j=_({clientName:[{required:!0,message:"\u5E94\u7528\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],redirectUris:[{validator:(n,l,i)=>{l||i(new Error("\u56DE\u8C03\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A"));for(const s of l)if(!s){i(new Error("\u56DE\u8C03\u5730\u5740\u4EFB\u610F\u4E00\u9879\u4E0D\u80FD\u4E3A\u7A7A"));return}i()},trigger:"blur"}],authorizationGrantTypes:[{type:"array",required:!0,message:"\u6388\u6743\u6A21\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],clientAuthenticationMethods:[{type:"array",required:!0,message:"\u5E94\u7528\u8BA4\u8BC1\u65B9\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],"tokenSettings.accessTokenTimeToLive":[{required:!0,message:"\u5FC5\u987B\u586B\u5199Token\u5B58\u6D3B\u65F6\u95F4",trigger:"blur"}],"tokenSettings.refreshTokenTimeToLive":[{required:!0,message:"\u5FC5\u987B\u586B\u5199RefreshToken\u5B58\u6D3B\u65F6\u95F4",trigger:"blur"}]}),T=_(),h=_(!1),J=()=>{var n;(n=T.value)==null||n.validate((l,i)=>{l&&(h.value=!0,le(e.value).then(s=>{h.value=!1,s.success?q({title:"\u63D0\u793A",message:"\u5E94\u7528\u6CE8\u518C\u6210\u529F.",type:"success"}):q({title:"\u63D0\u793A",message:s.message||"\u5E94\u7528\u6CE8\u518C\u5931\u8D25.",type:"error"})}).catch(()=>{h.value=!1}))})},y=n=>{switch(n){case"SECONDS":return"\u79D2";case"MINUTES":return"\u5206";case"HOURS":return"\u65F6";case"DAYS":return"\u5929"}return"\u79D2"},$=()=>{var n;U(),(n=T.value)==null||n.resetFields()},G=()=>{e.value.redirectUris.push("")},H=(n,l,i)=>{e.value.clientProfile=`http://k7fsqkhtbx.cdhttp.cn/system${n.data[0]}`};return(n,l)=>{const i=a("el-input"),s=a("el-form-item"),B=a("Refresh"),f=a("el-icon"),S=a("el-tooltip"),x=a("CopyDocument"),K=a("el-image"),Y=a("Plus"),W=a("el-upload"),v=a("el-checkbox"),w=a("el-checkbox-group"),Q=a("Delete"),X=a("el-link"),p=a("el-option"),I=a("el-select"),R=a("el-button"),Z=a("el-popconfirm"),ee=a("el-form");return e.value.clientSettings?(c(),g(ee,{key:0,rules:j.value,ref_key:"authInfo",ref:T,"scroll-to-error":"",class:"client-form","label-position":"top",model:e.value},{default:u(()=>[r("div",de,[r("div",null,[ce,t(s,{label:"\u5E94\u7528\u540D\u79F0",prop:"clientName",class:"basic-info"},{default:u(()=>[t(i,{modelValue:e.value.clientName,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value.clientName=o),placeholder:"\u5E94\u7528\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(s,{label:"AppId",style:{display:"flex"},class:"basic-info"},{default:u(()=>[t(i,{disabled:"",modelValue:e.value.clientId,"onUpdate:modelValue":l[1]||(l[1]=o=>e.value.clientId=o),placeholder:"AppId"},null,8,["modelValue"]),d("\xA0\xA0 "),t(S,{class:"box-item",effect:"dark",content:"\u91CD\u65B0\u751F\u6210App Id",placement:"top"},{default:u(()=>[t(f,{class:"hand-mouse",onClick:z},{default:u(()=>[t(B)]),_:1})]),_:1}),d("\xA0\xA0 "),t(S,{class:"box-item",effect:"dark",content:"\u590D\u5236\u5230\u526A\u5207\u677F",placement:"top"},{default:u(()=>[t(f,{class:"hand-mouse",onClick:l[2]||(l[2]=o=>E(N)(e.value.clientId))},{default:u(()=>[t(x)]),_:1})]),_:1})]),_:1}),t(s,{label:"AppSecret",class:"basic-info"},{default:u(()=>[t(i,{disabled:"",modelValue:e.value.clientSecret,"onUpdate:modelValue":l[3]||(l[3]=o=>e.value.clientSecret=o),placeholder:"AppSecret"},null,8,["modelValue"]),d("\xA0\xA0 "),t(S,{class:"box-item",effect:"dark",content:"\u91CD\u65B0\u751F\u6210App Secret",placement:"top"},{default:u(()=>[t(f,{class:"hand-mouse",onClick:M},{default:u(()=>[t(B)]),_:1})]),_:1}),d("\xA0\xA0 "),t(S,{class:"box-item",effect:"dark",content:"\u590D\u5236\u5230\u526A\u5207\u677F",placement:"top"},{default:u(()=>[t(f,{class:"hand-mouse",onClick:l[4]||(l[4]=o=>E(N)(e.value.clientSecret))},{default:u(()=>[t(x)]),_:1})]),_:1})]),_:1}),t(s,{label:"JwkSetUrl",class:"basic-info"},{default:u(()=>[t(i,{modelValue:e.value.clientSettings.jwkSetUrl,"onUpdate:modelValue":l[5]||(l[5]=o=>e.value.clientSettings.jwkSetUrl=o),placeholder:"JwkSetUrl"},null,8,["modelValue"])]),_:1})]),r("div",pe,[me,t(W,{class:"avatar-uploader",action:"http://k7fsqkhtbx.cdhttp.cn/system/file/upload",headers:E(P),"on-success":H,"show-file-list":!1},{default:u(()=>[e.value.clientProfile?(c(),g(K,{key:0,src:e.value.clientProfile,class:"avatar",fit:"cover"},null,8,["src"])):(c(),g(f,{key:1,class:"avatar-uploader-icon"},{default:u(()=>[t(Y)]),_:1}))]),_:1},8,["headers"])])]),r("div",fe,[r("div",ve,[r("div",_e,[ge,t(s,{label:"\u5E94\u7528\u8BBE\u7F6E",prop:"requireAuthorizationConsent"},{default:u(()=>[t(v,{modelValue:e.value.clientSettings.requireAuthorizationConsent,"onUpdate:modelValue":l[6]||(l[6]=o=>e.value.clientSettings.requireAuthorizationConsent=o)},{default:u(()=>[d(" \u6388\u6743\u786E\u8BA4 ")]),_:1},8,["modelValue"]),t(v,{modelValue:e.value.tokenSettings.reuseRefreshTokens,"onUpdate:modelValue":l[7]||(l[7]=o=>e.value.tokenSettings.reuseRefreshTokens=o)},{default:u(()=>[d(" \u91CD\u7528Refresh Token ")]),_:1},8,["modelValue"]),t(v,{modelValue:e.value.clientSettings.requireProofKey,"onUpdate:modelValue":l[8]||(l[8]=o=>e.value.clientSettings.requireProofKey=o)},{default:u(()=>[d(" \u4EC5\u652F\u6301PKCE ")]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"JwkSetUrl",class:"custom-width"},{default:u(()=>[t(i,{modelValue:e.value.clientSettings.jwkSetUrl,"onUpdate:modelValue":l[9]||(l[9]=o=>e.value.clientSettings.jwkSetUrl=o),placeholder:"JwkSetUrl"},null,8,["modelValue"])]),_:1}),t(s,{label:"\u6388\u6743\u6A21\u5F0F",prop:"authorizationGrantTypes"},{default:u(()=>[t(w,{modelValue:e.value.authorizationGrantTypes,"onUpdate:modelValue":l[10]||(l[10]=o=>e.value.authorizationGrantTypes=o)},{default:u(()=>[(c(!0),A(C,null,b(D.value.grant_types_supported,(o,m)=>(c(),g(v,{label:o,key:m},null,8,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),r("div",ke,[t(s,{label:"\u56DE\u8C03\u5730\u5740",class:"flex-item-wrap custom-width",prop:"redirectUris"},{default:u(()=>[(c(!0),A(C,null,b(e.value.redirectUris,(o,m)=>(c(),A("div",{key:m,style:{width:"100%"}},[t(i,{modelValue:e.value.redirectUris[m],"onUpdate:modelValue":L=>e.value.redirectUris[m]=L,placeholder:"\u56DE\u8C03\u5730\u5740"},null,8,["modelValue","onUpdate:modelValue"]),t(f,{onClick:L=>O(o,m),class:"icon-item"},{default:u(()=>[t(Q)]),_:2},1032,["onClick"])]))),128))]),_:1}),t(X,{icon:"CirclePlus",type:"primary",underline:!1,style:{margin:"0 0 10px 3px"},onClick:G},{default:u(()=>[d(" \u6DFB\u52A0\u56DE\u8C03\u5730\u5740 ")]),_:1}),t(s,{label:"\u5E94\u7528\u8BA4\u8BC1\u65B9\u5F0F",prop:"clientAuthenticationMethods"},{default:u(()=>[t(w,{modelValue:e.value.clientAuthenticationMethods,"onUpdate:modelValue":l[11]||(l[11]=o=>e.value.clientAuthenticationMethods=o)},{default:u(()=>[(c(!0),A(C,null,b(D.value.token_endpoint_auth_methods_supported,(o,m)=>(c(),g(v,{label:o,key:m},null,8,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),r("div",he,[t(s,{label:"Token\u5B58\u6D3B\u65F6\u95F4",prop:"tokenSettings.accessTokenTimeToLive"},{default:u(()=>[t(i,{modelValue:e.value.tokenSettings.accessTokenTimeToLive,"onUpdate:modelValue":l[13]||(l[13]=o=>e.value.tokenSettings.accessTokenTimeToLive=o),type:"number",placeholder:"Token\u5B58\u6D3B\u65F6\u95F4",class:"input-with-select"},{append:u(()=>[t(I,{modelValue:e.value.tokenSettings.accessTokenTimeToLiveUnit,"onUpdate:modelValue":l[12]||(l[12]=o=>e.value.tokenSettings.accessTokenTimeToLiveUnit=o),placeholder:y(e.value.tokenSettings.accessTokenTimeToLiveUnit)},{default:u(()=>[t(p,{label:"\u79D2",value:"SECONDS"}),t(p,{label:"\u5206",value:"MINUTES"}),t(p,{label:"\u65F6",value:"HOURS"}),t(p,{label:"\u5929",value:"DAYS"})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"Refresh Token\u5B58\u6D3B\u65F6\u95F4",prop:"tokenSettings.refreshTokenTimeToLive",style:{"margin-left":"55px"}},{default:u(()=>[t(i,{placeholder:"RefreshToken\u5B58\u6D3B\u65F6\u95F4",class:"input-with-select",type:"number",modelValue:e.value.tokenSettings.refreshTokenTimeToLive,"onUpdate:modelValue":l[15]||(l[15]=o=>e.value.tokenSettings.refreshTokenTimeToLive=o)},{append:u(()=>[t(I,{modelValue:e.value.tokenSettings.refreshTokenTimeToLiveUnit,"onUpdate:modelValue":l[14]||(l[14]=o=>e.value.tokenSettings.refreshTokenTimeToLiveUnit=o),placeholder:y(e.value.tokenSettings.refreshTokenTimeToLiveUnit)},{default:u(()=>[t(p,{label:"\u79D2",value:"SECONDS"}),t(p,{label:"\u5206",value:"MINUTES"}),t(p,{label:"\u65F6",value:"HOURS"}),t(p,{label:"\u5929",value:"DAYS"})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["modelValue"])]),_:1})])])]),t(s,null,{default:u(()=>[t(Z,{"confirm-button-text":"\u786E\u5B9A","cancel-button-text":"\u53D6\u6D88",icon:"InfoFilled","icon-color":"#626AEF",width:"220px",title:"\u63D0\u4EA4\u4E4B\u524D\u8BF7\u786E\u5B9A\u662F\u5426\u4FDD\u5B58\u597D\u4E86AppId\u4E0EAppSecret\uFF0C\u786E\u5B9A\u63D0\u4EA4?",onConfirm:J},{reference:u(()=>[t(R,{type:"primary",loading:h.value,style:{width:"150px"}},{default:u(()=>[d("\u4FDD\u5B58")]),_:1},8,["loading"])]),_:1}),t(R,{type:"info",plain:"",onClick:$},{default:u(()=>[d("\u91CD\u7F6E")]),_:1})]),_:1})])]),_:1},8,["rules","model"])):ne("",!0)}}});const Ve=re(Se,[["__scopeId","data-v-8cef9315"]]);export{Ve as default};
