import{c as N}from"./Utils.03a45ab7.js";import{g as te,c as ue}from"./ClientApi.bd7c2d25.js";import{n as S}from"./IdWorker.6114c90c.js";import{d as le,k as _,j as oe,r as a,o as d,c as g,w as l,m,b as t,e as r,f as E,g as A,h as b,F as C,i as ne,I as q,x as ae,y as se,J as ie}from"./index.01fb4aa9.js";import{_ as re}from"./_plugin-vue_export-helper.cdc0426e.js";import"./Request.91bcde67.js";const y=k=>(ae("data-v-68b17fbe"),k=k(),se(),k),de={class:"client-info"},ce=y(()=>m("div",{class:"header-text"},"\u57FA\u672C\u4FE1\u606F",-1)),pe={style:{"margin-left":"62px"}},me=y(()=>m("div",{class:"header-text"},"\u5E94\u7528Logo",-1)),fe=y(()=>m("div",{class:"header-text"},"\u8BA4\u8BC1\u76F8\u5173\u8BBE\u7F6E",-1)),ve={class:"el-input"},_e=le({__name:"SysClientRegister",setup(k){const e=_({}),B=()=>{e.value={},e.value.tokenSettings={},e.value.clientSettings={},e.value.redirectUris=[],e.value.redirectUris.push(""),e.value.clientId=String(S()),e.value.clientSecret=String(S()),e.value.scopes=[],e.value.scopes.push("read")};B();const P=oe(()=>{const n=window.localStorage.getItem("token");return n?new Headers({Authorization:n}):null}),z=()=>{e.value.clientId=String(S())},M=()=>{e.value.clientSecret=String(S())},D=_({});te().then(n=>{D.value=n});const O=(n,u)=>{n?ie.confirm(`\u786E\u5B9A\u5220\u9664\u56DE\u8C03\u5730\u5740\uFF1A${n}\u5417\uFF1F`,"Warning",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{e.value.redirectUris.splice(u,1)}):e.value.redirectUris.splice(u,1)},$=_({clientName:[{required:!0,message:"\u5E94\u7528\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],redirectUris:[{validator:(n,u,i)=>{u||i(new Error("\u56DE\u8C03\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A"));for(const s of u)if(!s){i(new Error("\u56DE\u8C03\u5730\u5740\u4EFB\u610F\u4E00\u9879\u4E0D\u80FD\u4E3A\u7A7A"));return}i()},trigger:"blur"}],authorizationGrantTypes:[{type:"array",required:!0,message:"\u6388\u6743\u6A21\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],clientAuthenticationMethods:[{type:"array",required:!0,message:"\u5E94\u7528\u8BA4\u8BC1\u65B9\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],"tokenSettings.accessTokenTimeToLive":[{required:!0,message:"\u5FC5\u987B\u586B\u5199Token\u5B58\u6D3B\u65F6\u95F4",trigger:"blur"}],"tokenSettings.refreshTokenTimeToLive":[{required:!0,message:"\u5FC5\u987B\u586B\u5199RefreshToken\u5B58\u6D3B\u65F6\u95F4",trigger:"blur"}]}),T=_(),h=_(!1),G=()=>{var n;(n=T.value)==null||n.validate((u,i)=>{u&&(h.value=!0,ue(e.value).then(s=>{h.value=!1,s.success?q({title:"\u63D0\u793A",message:"\u5E94\u7528\u6CE8\u518C\u6210\u529F.",type:"success"}):q({title:"\u63D0\u793A",message:s.message||"\u5E94\u7528\u6CE8\u518C\u5931\u8D25.",type:"error"})}).catch(()=>{h.value=!1}))})},V=n=>{switch(n){case"SECONDS":return"\u79D2";case"MINUTES":return"\u5206";case"HOURS":return"\u65F6";case"DAYS":return"\u5929"}return"\u79D2"},H=()=>{var n;B(),(n=T.value)==null||n.resetFields()},j=()=>{e.value.redirectUris.push("")},J=(n,u,i)=>{e.value.clientProfile=`http://k7fsqkhtbx.cdhttp.cn/system${n.data[0]}`};return(n,u)=>{const i=a("el-input"),s=a("el-form-item"),U=a("Refresh"),f=a("el-icon"),F=a("el-tooltip"),x=a("CopyDocument"),K=a("el-image"),Y=a("Plus"),W=a("el-upload"),Q=a("Delete"),X=a("el-link"),v=a("el-checkbox"),I=a("el-checkbox-group"),c=a("el-option"),w=a("el-select"),R=a("el-button"),Z=a("el-popconfirm"),ee=a("el-form");return e.value.clientSettings?(d(),g(ee,{key:0,rules:$.value,ref_key:"authInfo",ref:T,"scroll-to-error":"",class:"client-form","label-position":"top",model:e.value},{default:l(()=>[m("div",de,[m("div",null,[ce,t(s,{label:"\u5E94\u7528\u540D\u79F0",prop:"clientName",class:"basic-info"},{default:l(()=>[t(i,{modelValue:e.value.clientName,"onUpdate:modelValue":u[0]||(u[0]=o=>e.value.clientName=o),placeholder:"\u5E94\u7528\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(s,{label:"AppId",style:{display:"flex"},class:"basic-info"},{default:l(()=>[t(i,{disabled:"",modelValue:e.value.clientId,"onUpdate:modelValue":u[1]||(u[1]=o=>e.value.clientId=o),placeholder:"AppId"},null,8,["modelValue"]),r("\xA0\xA0 "),t(F,{class:"box-item",effect:"dark",content:"\u91CD\u65B0\u751F\u6210App Id",placement:"top"},{default:l(()=>[t(f,{class:"hand-mouse",onClick:z},{default:l(()=>[t(U)]),_:1})]),_:1}),r("\xA0\xA0 "),t(F,{class:"box-item",effect:"dark",content:"\u590D\u5236\u5230\u526A\u5207\u677F",placement:"top"},{default:l(()=>[t(f,{class:"hand-mouse",onClick:u[2]||(u[2]=o=>E(N)(e.value.clientId))},{default:l(()=>[t(x)]),_:1})]),_:1})]),_:1}),t(s,{label:"AppSecret",class:"basic-info"},{default:l(()=>[t(i,{disabled:"",modelValue:e.value.clientSecret,"onUpdate:modelValue":u[3]||(u[3]=o=>e.value.clientSecret=o),placeholder:"AppSecret"},null,8,["modelValue"]),r("\xA0\xA0 "),t(F,{class:"box-item",effect:"dark",content:"\u91CD\u65B0\u751F\u6210App Secret",placement:"top"},{default:l(()=>[t(f,{class:"hand-mouse",onClick:M},{default:l(()=>[t(U)]),_:1})]),_:1}),r("\xA0\xA0 "),t(F,{class:"box-item",effect:"dark",content:"\u590D\u5236\u5230\u526A\u5207\u677F",placement:"top"},{default:l(()=>[t(f,{class:"hand-mouse",onClick:u[4]||(u[4]=o=>E(N)(e.value.clientSecret))},{default:l(()=>[t(x)]),_:1})]),_:1})]),_:1}),t(s,{label:"JwkSetUrl",class:"basic-info"},{default:l(()=>[t(i,{modelValue:e.value.clientSettings.jwkSetUrl,"onUpdate:modelValue":u[5]||(u[5]=o=>e.value.clientSettings.jwkSetUrl=o),placeholder:"JwkSetUrl"},null,8,["modelValue"])]),_:1})]),m("div",pe,[me,t(W,{class:"avatar-uploader",action:"http://k7fsqkhtbx.cdhttp.cn/system/file/upload",headers:E(P),"on-success":J,"show-file-list":!1},{default:l(()=>[e.value.clientProfile?(d(),g(K,{key:0,src:e.value.clientProfile,class:"avatar",fit:"cover"},null,8,["src"])):(d(),g(f,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[t(Y)]),_:1}))]),_:1},8,["headers"])])]),fe,t(s,{label:"\u56DE\u8C03\u5730\u5740",class:"flex-item-wrap custom-width",prop:"redirectUris"},{default:l(()=>[(d(!0),A(C,null,b(e.value.redirectUris,(o,p)=>(d(),A("div",{key:p,style:{width:"100%"}},[t(i,{modelValue:e.value.redirectUris[p],"onUpdate:modelValue":L=>e.value.redirectUris[p]=L,placeholder:"\u56DE\u8C03\u5730\u5740"},null,8,["modelValue","onUpdate:modelValue"]),t(f,{onClick:L=>O(o,p),class:"icon-item"},{default:l(()=>[t(Q)]),_:2},1032,["onClick"])]))),128))]),_:1}),t(X,{icon:"CirclePlus",type:"primary",underline:!1,style:{margin:"0 0 10px 3px"},onClick:j},{default:l(()=>[r(" \u6DFB\u52A0\u56DE\u8C03\u5730\u5740 ")]),_:1}),t(s,{label:"\u6388\u6743\u6A21\u5F0F",prop:"authorizationGrantTypes"},{default:l(()=>[t(I,{modelValue:e.value.authorizationGrantTypes,"onUpdate:modelValue":u[6]||(u[6]=o=>e.value.authorizationGrantTypes=o)},{default:l(()=>[(d(!0),A(C,null,b(D.value.grant_types_supported,(o,p)=>(d(),g(v,{label:o,key:p},null,8,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"\u5E94\u7528\u8BA4\u8BC1\u65B9\u5F0F",prop:"clientAuthenticationMethods"},{default:l(()=>[t(I,{modelValue:e.value.clientAuthenticationMethods,"onUpdate:modelValue":u[7]||(u[7]=o=>e.value.clientAuthenticationMethods=o)},{default:l(()=>[(d(!0),A(C,null,b(D.value.token_endpoint_auth_methods_supported,(o,p)=>(d(),g(v,{label:o,key:p},null,8,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"\u5E94\u7528\u8BBE\u7F6E",prop:"requireAuthorizationConsent"},{default:l(()=>[t(v,{modelValue:e.value.clientSettings.requireAuthorizationConsent,"onUpdate:modelValue":u[8]||(u[8]=o=>e.value.clientSettings.requireAuthorizationConsent=o)},{default:l(()=>[r(" \u6388\u6743\u786E\u8BA4 ")]),_:1},8,["modelValue"]),t(v,{modelValue:e.value.tokenSettings.reuseRefreshTokens,"onUpdate:modelValue":u[9]||(u[9]=o=>e.value.tokenSettings.reuseRefreshTokens=o)},{default:l(()=>[r(" \u91CD\u7528Refresh Token ")]),_:1},8,["modelValue"]),t(v,{modelValue:e.value.clientSettings.requireProofKey,"onUpdate:modelValue":u[10]||(u[10]=o=>e.value.clientSettings.requireProofKey=o)},{default:l(()=>[r(" \u4EC5\u652F\u6301PKCE ")]),_:1},8,["modelValue"])]),_:1}),m("div",ve,[t(s,{label:"Token\u5B58\u6D3B\u65F6\u95F4",prop:"tokenSettings.accessTokenTimeToLive"},{default:l(()=>[t(i,{modelValue:e.value.tokenSettings.accessTokenTimeToLive,"onUpdate:modelValue":u[12]||(u[12]=o=>e.value.tokenSettings.accessTokenTimeToLive=o),type:"number",placeholder:"Token\u5B58\u6D3B\u65F6\u95F4",class:"input-with-select"},{append:l(()=>[t(w,{modelValue:e.value.tokenSettings.accessTokenTimeToLiveUnit,"onUpdate:modelValue":u[11]||(u[11]=o=>e.value.tokenSettings.accessTokenTimeToLiveUnit=o),placeholder:V(e.value.tokenSettings.accessTokenTimeToLiveUnit)},{default:l(()=>[t(c,{label:"\u79D2",value:"SECONDS"}),t(c,{label:"\u5206",value:"MINUTES"}),t(c,{label:"\u65F6",value:"HOURS"}),t(c,{label:"\u5929",value:"DAYS"})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"Refresh Token\u5B58\u6D3B\u65F6\u95F4",prop:"tokenSettings.refreshTokenTimeToLive",style:{"margin-left":"55px"}},{default:l(()=>[t(i,{placeholder:"RefreshToken\u5B58\u6D3B\u65F6\u95F4",class:"input-with-select",type:"number",modelValue:e.value.tokenSettings.refreshTokenTimeToLive,"onUpdate:modelValue":u[14]||(u[14]=o=>e.value.tokenSettings.refreshTokenTimeToLive=o)},{append:l(()=>[t(w,{modelValue:e.value.tokenSettings.refreshTokenTimeToLiveUnit,"onUpdate:modelValue":u[13]||(u[13]=o=>e.value.tokenSettings.refreshTokenTimeToLiveUnit=o),placeholder:V(e.value.tokenSettings.refreshTokenTimeToLiveUnit)},{default:l(()=>[t(c,{label:"\u79D2",value:"SECONDS"}),t(c,{label:"\u5206",value:"MINUTES"}),t(c,{label:"\u65F6",value:"HOURS"}),t(c,{label:"\u5929",value:"DAYS"})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["modelValue"])]),_:1})]),t(s,null,{default:l(()=>[t(Z,{"confirm-button-text":"\u786E\u5B9A","cancel-button-text":"\u53D6\u6D88",icon:"InfoFilled","icon-color":"#626AEF",width:"220px",title:"\u63D0\u4EA4\u4E4B\u524D\u8BF7\u786E\u5B9A\u662F\u5426\u4FDD\u5B58\u597D\u4E86AppId\u4E0EAppSecret\uFF0C\u786E\u5B9A\u63D0\u4EA4?",onConfirm:G},{reference:l(()=>[t(R,{type:"primary",loading:h.value,style:{width:"150px"}},{default:l(()=>[r("\u4FDD\u5B58")]),_:1},8,["loading"])]),_:1}),t(R,{type:"info",plain:"",onClick:H},{default:l(()=>[r("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["rules","model"])):ne("",!0)}}});const Te=re(_e,[["__scopeId","data-v-68b17fbe"]]);export{Te as default};
